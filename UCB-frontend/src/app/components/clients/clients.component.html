<app-navbar></app-navbar>
<div class="background center">
    <div class="record">
        <div class="options-list">
            <div class="paginacion">
                <!-- Filtros de la tabla -->
                <div class="paginator-container">
                    <div class="filter">
                        <h3>Registros por página</h3>
                        <select [(ngModel)]="inputValue2" name="size" (ngModelChange)="onInputChange()">
                            <option value="5" selected hidden>5</option>
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="25">25</option>
                        </select>   
                        <div class="page-info">
                            <h3>{{ inicio }} - {{ fin }} de {{total}}</h3>
                        </div>
                        <button (click)="onPageChange(paginaActual - 1)" [disabled]="paginaActual === 1">
                            <span>&lt;</span>
                        </button>
                        <button (click)="onPageChange(paginaActual + 1)" [disabled]="paginaActual * inputValue2 >= users.length">
                            <span>&gt;</span>
                        </button>
                    </div>
                    <button class="button" (click)="newRecord()">Agregar nuevo cliente</button>
                </div>
            </div>
            <!-- Cabezera de la tabla -->
            <div class="info">
                <h3>Nombre</h3>
                <h3>Apellido</h3>
                <h3>Email</h3>
                <h3>Número</h3>
            </div>
            <!-- Lista de auditorias -->
            <div *ngFor="let user of usersFilter">
                <div class="audit-list">
                    <div class="audit">
                        <h4>{{user.name}}</h4>
                    </div>
                    <div class="audit">
                        <h4>{{user.lastName}}</h4>
                    </div>
                    <div class="audit">
                        <h4>{{user.email}}</h4>
                    </div>
                    <div class="audit">
                        <h4>{{user.phone}}</h4>
                    </div>
                    <div class="icons">
                        <i class="fa-solid fa-pen edit-button" style="color: #6988F5;" (click)="editClient(user.clientId)" ></i>
                        <i class="fa-solid fa-trash delete-button icon" style="color: #F22D2D;" (click)="deleteClient(user.clientId)"></i>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div>
            <h3>{{total}} Clientes</h3> 
        </div>
    </div>
    <!--Cargando-->
    <div class="popup center" *ngIf="loadingPopup">
        <div class="success center">
            <div>
                <div class="confirmation-content" style="margin-bottom: 20px;">
                    <i class="fas fa-spinner fa-spin" style="color: #16428B;"></i>
                </div>
                <div class="confirmation-content"><p>Procesando datos, por favor espere</p></div>
            </div>
        </div>
    </div>          
    <!--Mensaje de que todo salio bien y el cliente fue registrada correctamente-->
    <div class="popup center" *ngIf="confirmationPopup">
        <div class="success center">
            <div>
                <div class="confirmation-content"><i class="fa-solid fa-circle-check" style="color: #30ff24;"></i></div>
                <div class="confirmation-content"><p>El cliente fue registrado correctamente</p></div>
                <div class="confirmation-content"><button (click)="confirmationPopup = false">Aceptar</button></div>
            </div>
        </div>
    </div>
    <!--Mensaje de que algo salio mal al momento de registrar al cliente-->
    <div class="popup center" *ngIf="errorPopup">
        <div class="success center">
            <div>
                <div class="confirmation-content"><i class="fa-solid fa-circle-xmark" style="color: #ff4d4d;"></i></div>
                <div class="confirmation-content"><p>Ocurrió un error, el cliente no pudo<br>ser registrado, correo ya existente</p></div>
                <div class="confirmation-content"><button (click)="errorPopup = false">Aceptar</button></div>
            </div>
        </div>
    </div>    
</div>

<!-- Popup -->
<div class="overlay" *ngIf="isDialogVisible"></div> <!-- Fondo oscuro -->
<div class="custom-confirm-dialog" *ngIf="isDialogVisible">
    <div class="dialog-content">
        <h5>Nuevo cliente</h5>
        <hr>
        <h6>Información</h6>
        <div class="column">
            <div>
                <h6>Nombre</h6>
                <div class="input-container">
                    <input type="text" placeholder="Ingrese nombre" id="nombre" [(ngModel)]="name">
                    <i class="fas fa-user icon" id="icon"></i>
                </div> 
            </div>
            <div>
                <h6>Apellido</h6> 
                <div class="input-container">
                    <input type="text" placeholder="Ingrese apellido" id="file" [(ngModel)]="lastName">
                    <i class="fas fa-user icon" id="icon"></i>
                </div>
            </div>
            <div>
                <h6>Número de contacto</h6>
                <div class="input-container">
                    <input type="text" placeholder="Ingresa telefono" id="nombre" [(ngModel)]="phone" onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                    <i class="fa-solid fa-phone icon" id="icon"></i>
                </div> 
            </div>
            <div>
                <h6>Ingrese correo electronico</h6> 
                <div class="input-container">
                    <input type="text" placeholder="Ingresa correo electronico" id="file" [(ngModel)]="email">
                    <i class="fa-solid fa-envelope icon" id="icon"></i>
                </div>
            </div>            
        </div>
        <hr>
        <h6>Compañia</h6> 
        <div class="input-container">
            <select class="select-company" [(ngModel)]="inputValue1" name="size" (ngModelChange)="onInputChange()">
                <option *ngFor="let company of companys" value="{{company.companyId}}">{{company.name}}</option>
            </select> 
            <i class="fa-solid fa-building icon" id="icon"></i>
        </div>  
        <h6>Cargo</h6> 
        <div class="input-container">
            <input type="text" placeholder="Ingrese su cargo" id="file" [(ngModel)]="position">
            <i class="fa-solid fa-lock icon" id="icon"></i>
        </div>   
        <h6>Contraseña</h6> 
        <div class="input-container">
            <input type="text" placeholder="Ingrese su cargo" id="file" [(ngModel)]="password">
            <i class="fa-solid fa-lock icon" id="icon"></i>
        </div>                
    </div>
    <div #errorMessage class="error-message">Por favor llene todos los campos.</div>                    
    <div class="dialog-actions">
        <button (click)="confirm()" class="Aceptar">Crear</button>
        <button (click)="cancel()" class="Cancelar">Cancelar</button>
    </div>
</div>

<!-- Popup Edit-->
<div class="overlay" *ngIf="isDialogVisibleEdit"></div> <!-- Fondo oscuro -->
<div class="custom-confirm-dialog" *ngIf="isDialogVisibleEdit">
    <div class="dialog-content">
        <h5>Editar cliente</h5>
        <hr>
        <h6>Información</h6>
        <div class="column">
            <div>
                <h6>Nombre</h6>
                <div class="input-container">
                    <input type="text" placeholder="Ingrese nombre" id="nameEdit" [(ngModel)]="nameEdit" disabled>
                    <i class="fas fa-user icon" id="icon"></i>
                </div> 
            </div>
            <div>
                <h6>Apellido</h6> 
                <div class="input-container">
                    <input type="text" placeholder="Ingrese apellido" id="lastNameEdit" [(ngModel)]="lastNameEdit" disabled>
                    <i class="fas fa-user icon" id="icon"></i>
                </div>
            </div>
            <div>
                <h6>Número de contacto</h6>
                <div class="input-container">
                    <input type="text" placeholder="Ingresa telefono" id="phoneEdit" [(ngModel)]="phoneEdit">
                    <i class="fa-solid fa-phone icon" id="icon"></i>
                </div> 
            </div>
            <div>
                <h6>Ingrese correo electronico</h6> 
                <div class="input-container">
                    <input type="text" placeholder="Ingresa correo electronico" id="emailEdit" [(ngModel)]="emailEdit" disabled>
                    <i class="fa-solid fa-envelope icon" id="icon"></i>
                </div>
            </div>            
        </div>
        <hr>
        <h6>Compañia</h6> 
        <div class="input-container">
            <select class="select-company" [(ngModel)]="companyEdit" name="size" (ngModelChange)="onInputChange()">
                <option *ngFor="let company of companys" value="{{company.companyId}}">{{company.name}}</option>
            </select> 
            <i class="fa-solid fa-building icon" id="icon"></i>

            <i class="fa-solid fa-building icon" id="icon"></i>
        </div>  
        <h6>Cargo</h6> 
        <div class="input-container">
            <input type="text" placeholder="Ingrese su cargo" id="positionEdit" [(ngModel)]="positionEdit">
            <i class="fa-solid fa-lock icon" id="icon"></i>
        </div>   
        <h6>Contraseña</h6> 
        <div class="input-container">
            <input type="text" placeholder="Ingrese su contraseña" id="passwordEdit" [(ngModel)]="passwordEdit">
            <i class="fa-solid fa-lock icon" id="icon"></i>
        </div>                
    </div>
    <div #errorMessage class="error-message">Por favor llene todos los campos.</div>                    
    <div class="dialog-actions">
        <button (click)="confirmEdit()" class="Aceptar">Editar</button>
        <button (click)="cancelEdit()" class="Cancelar">Cancelar</button>
    </div>
</div>
<!-- Popup de eliminación-->
<div class="overlay" *ngIf="isDeleteDialogVisible"></div> <!-- Fondo oscuro -->
<div class="custom-confirm-dialog-delete" *ngIf="isDeleteDialogVisible">
    <div class="dialog-content">
        <h5>Eliminar cliente</h5>
        <hr>
        <h6>¿Está seguro que desea eliminar al cliente?</h6>
    </div>
    <div class="dialog-actions">
        <button (click)="confirmDelete()" class="Aceptar">Eliminar</button>
        <button (click)="cancelDelete()" class="Cancelar">Cancelar</button>
    </div>
</div>


